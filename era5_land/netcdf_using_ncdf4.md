netCDF in R using Rpackage `ncdf4`
================

``` r
pacman::p_load(
    rio,            # import and export files
    here,           # locate files 
    tidyverse,      # data management and visualization
    ncdf4,          # work with netCDF file
    CFtime,         # convert time variable
    RColorBrewer
)
```

## Open netCDF file

``` r
# open #-----------
ncpath <- here("era5_land/KrigR_temp_raw.nc")

ncdata <- ncdf4::nc_open(ncpath)
print(ncdata)
```

    ## File G:/My Drive/git/note_environmental_data/era5_land/KrigR_temp_raw.nc (NC_FORMAT_NETCDF4):
    ## 
    ##      2 variables (excluding dimension variables):
    ##         float KrigR_temp_raw[longitude,latitude,time]   (Chunking: [85,30,96])  (Compression: level 9)
    ##             _FillValue: -1.17549402418441e+38
    ##             grid_mapping: crs
    ##         int crs[]   (Contiguous storage)  
    ##             crs_wkt: GEOGCRS["Coordinate System imported from GRIB file",    DATUM["unnamed",        ELLIPSOID["Sphere",6367470,0,            LENGTHUNIT["metre",1,                ID["EPSG",9001]]]],    PRIMEM["Greenwich",0,        ANGLEUNIT["degree",0.0174532925199433,            ID["EPSG",9122]]],    CS[ellipsoidal,2],        AXIS["latitude",north,            ORDER[1],            ANGLEUNIT["degree",0.0174532925199433,                ID["EPSG",9122]]],        AXIS["longitude",east,            ORDER[2],            ANGLEUNIT["degree",0.0174532925199433,                ID["EPSG",9122]]]]
    ##             spatial_ref: GEOGCRS["Coordinate System imported from GRIB file",    DATUM["unnamed",        ELLIPSOID["Sphere",6367470,0,            LENGTHUNIT["metre",1,                ID["EPSG",9001]]]],    PRIMEM["Greenwich",0,        ANGLEUNIT["degree",0.0174532925199433,            ID["EPSG",9122]]],    CS[ellipsoidal,2],        AXIS["latitude",north,            ORDER[1],            ANGLEUNIT["degree",0.0174532925199433,                ID["EPSG",9122]]],        AXIS["longitude",east,            ORDER[2],            ANGLEUNIT["degree",0.0174532925199433,                ID["EPSG",9122]]]]
    ##             proj4: +proj=longlat +R=6367470 +no_defs
    ##             geotransform: -83.72499999999999431566 0.09999999999999983901766 0 39.49099999999999965894 0 -0.1000000000000000055511
    ## 
    ##      3 dimensions:
    ##         longitude  Size:85 
    ##             units: degrees_east
    ##             long_name: longitude
    ##         latitude  Size:30 
    ##             units: degrees_north
    ##             long_name: latitude
    ##         time  Size:96 
    ##             units: seconds since 1970-1-1 00:00:00
    ##             long_name: time
    ##             calendar: standard
    ## 
    ##     18 global attributes:
    ##         Conventions: CF-1.4
    ##         created_by: R packages ncdf4 and terra (version 1.7-83)
    ##         date: 2025-04-16 17:16:19
    ##         Citation: reanalysis-era5-land data (DOI:10.24381/cds.e2161bac) obtained with KrigR (DOI:10.1088/1748-9326/ac48b3) on 2025-04-16 17:15:24.268546
    ##         KrigRCall.Variable: 2m_temperature
    ##         KrigRCall.CumulVar: FALSE
    ##         KrigRCall.DataSet: reanalysis-era5-land
    ##         KrigRCall.Type: NA
    ##         KrigRCall.DateStart: 2016-01-01 00:00
    ##         KrigRCall.DateStop: 2016-01-04 23:00
    ##         KrigRCall.TZone: US/Eastern
    ##         KrigRCall.TResolution: hour
    ##         KrigRCall.TStep: 1
    ##         KrigRCall.FUN: mean
    ##         KrigRCall.Extent: Extent
    ##         KrigRCall.Buffer: 0.5
    ##         KrigRCall.Dir: G:/My Drive/git/note_environmental_data/era5_land
    ##         KrigRCall.FileName: KrigR_temp_raw.nc

## Get variables

``` r
# get variables #-----------------------
# longitude
(lon <- ncvar_get(ncdata, "longitude"))
```

    ##  [1] -83.675 -83.575 -83.475 -83.375 -83.275 -83.175 -83.075 -82.975 -82.875 -82.775
    ## [11] -82.675 -82.575 -82.475 -82.375 -82.275 -82.175 -82.075 -81.975 -81.875 -81.775
    ## [21] -81.675 -81.575 -81.475 -81.375 -81.275 -81.175 -81.075 -80.975 -80.875 -80.775
    ## [31] -80.675 -80.575 -80.475 -80.375 -80.275 -80.175 -80.075 -79.975 -79.875 -79.775
    ## [41] -79.675 -79.575 -79.475 -79.375 -79.275 -79.175 -79.075 -78.975 -78.875 -78.775
    ## [51] -78.675 -78.575 -78.475 -78.375 -78.275 -78.175 -78.075 -77.975 -77.875 -77.775
    ## [61] -77.675 -77.575 -77.475 -77.375 -77.275 -77.175 -77.075 -76.975 -76.875 -76.775
    ## [71] -76.675 -76.575 -76.475 -76.375 -76.275 -76.175 -76.075 -75.975 -75.875 -75.775
    ## [81] -75.675 -75.575 -75.475 -75.375 -75.275

``` r
head(lon)
```

    ## [1] -83.675 -83.575 -83.475 -83.375 -83.275 -83.175

``` r
dim(lon)
```

    ## [1] 85

``` r
# latitude
(lat <- ncvar_get(ncdata, "latitude"))
```

    ##  [1] 39.441 39.341 39.241 39.141 39.041 38.941 38.841 38.741 38.641 38.541 38.441 38.341
    ## [13] 38.241 38.141 38.041 37.941 37.841 37.741 37.641 37.541 37.441 37.341 37.241 37.141
    ## [25] 37.041 36.941 36.841 36.741 36.641 36.541

``` r
head(lat)
```

    ## [1] 39.441 39.341 39.241 39.141 39.041 38.941

``` r
dim(lat)
```

    ## [1] 30

``` r
# time
(time <- ncvar_get(ncdata, "time"))
```

    ##  [1] 1451624400 1451628000 1451631600 1451635200 1451638800 1451642400 1451646000
    ##  [8] 1451649600 1451653200 1451656800 1451660400 1451664000 1451667600 1451671200
    ## [15] 1451674800 1451678400 1451682000 1451685600 1451689200 1451692800 1451696400
    ## [22] 1451700000 1451703600 1451707200 1451710800 1451714400 1451718000 1451721600
    ## [29] 1451725200 1451728800 1451732400 1451736000 1451739600 1451743200 1451746800
    ## [36] 1451750400 1451754000 1451757600 1451761200 1451764800 1451768400 1451772000
    ## [43] 1451775600 1451779200 1451782800 1451786400 1451790000 1451793600 1451797200
    ## [50] 1451800800 1451804400 1451808000 1451811600 1451815200 1451818800 1451822400
    ## [57] 1451826000 1451829600 1451833200 1451836800 1451840400 1451844000 1451847600
    ## [64] 1451851200 1451854800 1451858400 1451862000 1451865600 1451869200 1451872800
    ## [71] 1451876400 1451880000 1451883600 1451887200 1451890800 1451894400 1451898000
    ## [78] 1451901600 1451905200 1451908800 1451912400 1451916000 1451919600 1451923200
    ## [85] 1451926800 1451930400 1451934000 1451937600 1451941200 1451944800 1451948400
    ## [92] 1451952000 1451955600 1451959200 1451962800 1451966400

``` r
head(time)
```

    ## [1] 1451624400 1451628000 1451631600 1451635200 1451638800 1451642400

``` r
dim(time)
```

    ## [1] 96

``` r
(tunits <- ncatt_get(ncdata, "time", "units"))
```

    ## $hasatt
    ## [1] TRUE
    ## 
    ## $value
    ## [1] "seconds since 1970-1-1 00:00:00"

``` r
dim(time)
```

    ## [1] 96

``` r
# temperature
temp_array <- ncvar_get(ncdata)
dim(temp_array)
```

    ## [1] 85 30 96

``` r
# first "time" layer
temp_array[, , 1]
```

    ##           [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]
    ##  [1,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [2,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [3,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [4,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [5,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [6,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [7,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [8,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [9,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [10,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [11,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [12,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [13,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [14,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [15,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [16,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [17,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [18,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [19,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [20,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [21,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [22,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [23,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [24,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [25,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [26,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [27,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [28,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [29,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [30,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [31,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [32,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [33,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##          [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]    [,17]    [,18]
    ##  [1,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [2,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [3,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [4,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [5,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [6,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [7,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [8,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [9,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [10,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [11,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [12,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [13,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [14,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [15,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [16,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [17,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [18,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [19,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [20,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [21,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [22,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [23,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [24,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [25,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [26,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [27,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [28,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [29,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [30,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [31,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [32,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [33,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##          [,19]    [,20]    [,21]    [,22]    [,23]    [,24]    [,25]    [,26]    [,27]
    ##  [1,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [2,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [3,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [4,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [5,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [6,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [7,]       NA       NA       NA       NA       NA       NA       NA       NA 274.8950
    ##  [8,]       NA       NA       NA       NA       NA       NA       NA       NA 274.9756
    ##  [9,]       NA       NA       NA       NA       NA       NA 274.4556 274.5007 275.0090
    ## [10,]       NA       NA       NA       NA       NA 274.7222 274.4631 274.5129 275.0522
    ## [11,]       NA       NA       NA       NA       NA 274.7561 274.4963 274.5654 275.1133
    ## [12,]       NA       NA       NA       NA 275.0718 274.8101 274.6060 274.6907 275.2852
    ## [13,]       NA       NA       NA       NA 275.1138 274.9163 274.7407 274.8853 275.4905
    ## [14,]       NA       NA       NA       NA 275.1560 274.9822 274.8818 275.0447 275.6780
    ## [15,]       NA       NA       NA 275.3374 275.1155 275.0125 274.9424 275.1609 275.7964
    ## [16,]       NA       NA 275.4934 275.2363 275.0400 274.9609 274.9814 275.2012 275.7708
    ## [17,]       NA 275.5215 275.3857 275.1238 274.9346 274.9194 274.9714 275.2131 275.7612
    ## [18,]       NA 275.4014 275.2717 275.0088 274.8267 274.8315 274.9395 275.1797 275.6365
    ## [19,]       NA       NA 275.1465 274.8879 274.7080 274.7273 274.8445 275.0508 275.4624
    ## [20,]       NA       NA       NA       NA 274.5918 274.6108 274.7290 274.9148 275.1802
    ## [21,]       NA       NA       NA       NA 274.4495 274.4915 274.6096 274.7722 274.9895
    ## [22,]       NA       NA       NA       NA 274.2739 274.3311 274.5083 274.6733 274.8601
    ## [23,]       NA       NA       NA       NA 274.0413 274.1792 274.3835 274.6082 274.8040
    ## [24,]       NA       NA       NA 273.8848 273.8757 274.0422 274.3164 274.5583 274.8032
    ## [25,]       NA       NA       NA 273.8896 273.8826 274.0898 274.3872 274.6826 274.9548
    ## [26,]       NA       NA       NA       NA 274.1538 274.3728 274.6641 274.9546 275.2510
    ## [27,]       NA       NA       NA 274.2874 274.4124 274.6475 274.9365 275.2449 275.5618
    ## [28,]       NA       NA       NA 274.5137 274.6919 274.9233 275.1694 275.4895 275.8494
    ## [29,]       NA       NA 274.5850 274.7959 274.9817 275.1611 275.3765 275.6348 276.0103
    ## [30,]       NA       NA 274.8401 275.0718 275.2861 275.4373 275.5330 275.7773 276.1858
    ## [31,]       NA       NA 275.0413 275.3257 275.5461 275.6492 275.7085 275.9219 276.3455
    ## [32,]       NA       NA 275.1426 275.4341 275.6877 275.7952 275.8545 276.0696 276.5581
    ## [33,]       NA       NA 275.1902 275.5098 275.7744 275.9141 275.9805 276.2407 276.7573
    ##          [,28]    [,29]    [,30]
    ##  [1,]       NA 275.0647       NA
    ##  [2,]       NA 275.1257       NA
    ##  [3,]       NA 275.1980       NA
    ##  [4,] 274.9604 275.3040       NA
    ##  [5,] 275.1165 275.4795       NA
    ##  [6,] 275.2695 275.7356       NA
    ##  [7,] 275.4827 275.9766       NA
    ##  [8,] 275.6084 276.1677       NA
    ##  [9,] 275.7039 276.2778       NA
    ## [10,] 275.7612 276.3674       NA
    ## [11,] 275.8757 276.4917       NA
    ## [12,] 276.0642 276.6567       NA
    ## [13,] 276.2708 276.8467       NA
    ## [14,] 276.4597 276.9724       NA
    ## [15,] 276.5176 276.9946       NA
    ## [16,] 276.4636 276.8245       NA
    ## [17,] 276.3694 276.6826       NA
    ## [18,] 276.2131 276.4226       NA
    ## [19,] 275.8491 276.0286       NA
    ## [20,] 275.5015 275.6147       NA
    ## [21,] 275.1851 275.2896 275.3157
    ## [22,] 275.0322 275.2151 275.3274
    ## [23,] 275.0073 275.2507 275.6631
    ## [24,] 275.0215 275.4121 275.9216
    ## [25,] 275.2332 275.6719 276.3574
    ## [26,] 275.5510 276.0955 276.8406
    ## [27,] 275.9248 276.5022 277.3730
    ## [28,] 276.2278 276.8877 277.8005
    ## [29,] 276.4705 277.1655 278.1960
    ## [30,] 276.6699 277.4463 278.5154
    ## [31,] 276.9077 277.7139 278.8621
    ## [32,] 277.1499 278.0056 279.1602
    ## [33,] 277.4338 278.2947 279.3733
    ##  [ reached getOption("max.print") -- omitted 52 rows ]

## Reshaping from raster to rectangular

``` r
# raster to dataframe #-----------------------
```

### Convert time variable

``` r
## convert time #------------
# convert time stored as “time-since some origin” to CFtime class
# decode time
cf <- CFtime::CFtime(tunits$value,
             calendar = "proleptic_gregorian",
             time)
cf
```

    ## CF calendar:
    ##   Origin  : 1970-01-01T00:00:00
    ##   Units   : seconds
    ##   Type    : proleptic_gregorian
    ## Time series:
    ##   Elements: [2016-01-01T05:00:00 .. 2016-01-05T04:00:00] (average of 3600.000000 seconds between 96 elements)
    ##   Bounds  : not set

``` r
# get character-string times
timestamps <- CFtime::as_timestamp(cf) 
timestamps
```

    ##  [1] "2016-01-01T05:00:00" "2016-01-01T06:00:00" "2016-01-01T07:00:00"
    ##  [4] "2016-01-01T08:00:00" "2016-01-01T09:00:00" "2016-01-01T10:00:00"
    ##  [7] "2016-01-01T11:00:00" "2016-01-01T12:00:00" "2016-01-01T13:00:00"
    ## [10] "2016-01-01T14:00:00" "2016-01-01T15:00:00" "2016-01-01T16:00:00"
    ## [13] "2016-01-01T17:00:00" "2016-01-01T18:00:00" "2016-01-01T19:00:00"
    ## [16] "2016-01-01T20:00:00" "2016-01-01T21:00:00" "2016-01-01T22:00:00"
    ## [19] "2016-01-01T23:00:00" "2016-01-02T00:00:00" "2016-01-02T01:00:00"
    ## [22] "2016-01-02T02:00:00" "2016-01-02T03:00:00" "2016-01-02T04:00:00"
    ## [25] "2016-01-02T05:00:00" "2016-01-02T06:00:00" "2016-01-02T07:00:00"
    ## [28] "2016-01-02T08:00:00" "2016-01-02T09:00:00" "2016-01-02T10:00:00"
    ## [31] "2016-01-02T11:00:00" "2016-01-02T12:00:00" "2016-01-02T13:00:00"
    ## [34] "2016-01-02T14:00:00" "2016-01-02T15:00:00" "2016-01-02T16:00:00"
    ## [37] "2016-01-02T17:00:00" "2016-01-02T18:00:00" "2016-01-02T19:00:00"
    ## [40] "2016-01-02T20:00:00" "2016-01-02T21:00:00" "2016-01-02T22:00:00"
    ## [43] "2016-01-02T23:00:00" "2016-01-03T00:00:00" "2016-01-03T01:00:00"
    ## [46] "2016-01-03T02:00:00" "2016-01-03T03:00:00" "2016-01-03T04:00:00"
    ## [49] "2016-01-03T05:00:00" "2016-01-03T06:00:00" "2016-01-03T07:00:00"
    ## [52] "2016-01-03T08:00:00" "2016-01-03T09:00:00" "2016-01-03T10:00:00"
    ## [55] "2016-01-03T11:00:00" "2016-01-03T12:00:00" "2016-01-03T13:00:00"
    ## [58] "2016-01-03T14:00:00" "2016-01-03T15:00:00" "2016-01-03T16:00:00"
    ## [61] "2016-01-03T17:00:00" "2016-01-03T18:00:00" "2016-01-03T19:00:00"
    ## [64] "2016-01-03T20:00:00" "2016-01-03T21:00:00" "2016-01-03T22:00:00"
    ## [67] "2016-01-03T23:00:00" "2016-01-04T00:00:00" "2016-01-04T01:00:00"
    ## [70] "2016-01-04T02:00:00" "2016-01-04T03:00:00" "2016-01-04T04:00:00"
    ## [73] "2016-01-04T05:00:00" "2016-01-04T06:00:00" "2016-01-04T07:00:00"
    ## [76] "2016-01-04T08:00:00" "2016-01-04T09:00:00" "2016-01-04T10:00:00"
    ## [79] "2016-01-04T11:00:00" "2016-01-04T12:00:00" "2016-01-04T13:00:00"
    ## [82] "2016-01-04T14:00:00" "2016-01-04T15:00:00" "2016-01-04T16:00:00"
    ## [85] "2016-01-04T17:00:00" "2016-01-04T18:00:00" "2016-01-04T19:00:00"
    ## [88] "2016-01-04T20:00:00" "2016-01-04T21:00:00" "2016-01-04T22:00:00"
    ## [91] "2016-01-04T23:00:00" "2016-01-05T00:00:00" "2016-01-05T01:00:00"
    ## [94] "2016-01-05T02:00:00" "2016-01-05T03:00:00" "2016-01-05T04:00:00"

``` r
# parse the string into date components
time_cf <- CFtime::parse_timestamps(cf, timestamps)
time_cf
```

    ##    year month day hour minute second    tz     offset
    ## 1  2016     1   1    5      0      0 +0000 1451624400
    ## 2  2016     1   1    6      0      0 +0000 1451628000
    ## 3  2016     1   1    7      0      0 +0000 1451631600
    ## 4  2016     1   1    8      0      0 +0000 1451635200
    ## 5  2016     1   1    9      0      0 +0000 1451638800
    ## 6  2016     1   1   10      0      0 +0000 1451642400
    ## 7  2016     1   1   11      0      0 +0000 1451646000
    ## 8  2016     1   1   12      0      0 +0000 1451649600
    ## 9  2016     1   1   13      0      0 +0000 1451653200
    ## 10 2016     1   1   14      0      0 +0000 1451656800
    ## 11 2016     1   1   15      0      0 +0000 1451660400
    ## 12 2016     1   1   16      0      0 +0000 1451664000
    ## 13 2016     1   1   17      0      0 +0000 1451667600
    ## 14 2016     1   1   18      0      0 +0000 1451671200
    ## 15 2016     1   1   19      0      0 +0000 1451674800
    ## 16 2016     1   1   20      0      0 +0000 1451678400
    ## 17 2016     1   1   21      0      0 +0000 1451682000
    ## 18 2016     1   1   22      0      0 +0000 1451685600
    ## 19 2016     1   1   23      0      0 +0000 1451689200
    ## 20 2016     1   2    0      0      0 +0000 1451692800
    ## 21 2016     1   2    1      0      0 +0000 1451696400
    ## 22 2016     1   2    2      0      0 +0000 1451700000
    ## 23 2016     1   2    3      0      0 +0000 1451703600
    ## 24 2016     1   2    4      0      0 +0000 1451707200
    ## 25 2016     1   2    5      0      0 +0000 1451710800
    ## 26 2016     1   2    6      0      0 +0000 1451714400
    ## 27 2016     1   2    7      0      0 +0000 1451718000
    ## 28 2016     1   2    8      0      0 +0000 1451721600
    ## 29 2016     1   2    9      0      0 +0000 1451725200
    ## 30 2016     1   2   10      0      0 +0000 1451728800
    ## 31 2016     1   2   11      0      0 +0000 1451732400
    ## 32 2016     1   2   12      0      0 +0000 1451736000
    ## 33 2016     1   2   13      0      0 +0000 1451739600
    ## 34 2016     1   2   14      0      0 +0000 1451743200
    ## 35 2016     1   2   15      0      0 +0000 1451746800
    ## 36 2016     1   2   16      0      0 +0000 1451750400
    ## 37 2016     1   2   17      0      0 +0000 1451754000
    ## 38 2016     1   2   18      0      0 +0000 1451757600
    ## 39 2016     1   2   19      0      0 +0000 1451761200
    ## 40 2016     1   2   20      0      0 +0000 1451764800
    ## 41 2016     1   2   21      0      0 +0000 1451768400
    ## 42 2016     1   2   22      0      0 +0000 1451772000
    ## 43 2016     1   2   23      0      0 +0000 1451775600
    ## 44 2016     1   3    0      0      0 +0000 1451779200
    ## 45 2016     1   3    1      0      0 +0000 1451782800
    ## 46 2016     1   3    2      0      0 +0000 1451786400
    ## 47 2016     1   3    3      0      0 +0000 1451790000
    ## 48 2016     1   3    4      0      0 +0000 1451793600
    ## 49 2016     1   3    5      0      0 +0000 1451797200
    ## 50 2016     1   3    6      0      0 +0000 1451800800
    ## 51 2016     1   3    7      0      0 +0000 1451804400
    ## 52 2016     1   3    8      0      0 +0000 1451808000
    ## 53 2016     1   3    9      0      0 +0000 1451811600
    ## 54 2016     1   3   10      0      0 +0000 1451815200
    ## 55 2016     1   3   11      0      0 +0000 1451818800
    ## 56 2016     1   3   12      0      0 +0000 1451822400
    ## 57 2016     1   3   13      0      0 +0000 1451826000
    ## 58 2016     1   3   14      0      0 +0000 1451829600
    ## 59 2016     1   3   15      0      0 +0000 1451833200
    ## 60 2016     1   3   16      0      0 +0000 1451836800
    ## 61 2016     1   3   17      0      0 +0000 1451840400
    ## 62 2016     1   3   18      0      0 +0000 1451844000
    ## 63 2016     1   3   19      0      0 +0000 1451847600
    ## 64 2016     1   3   20      0      0 +0000 1451851200
    ## 65 2016     1   3   21      0      0 +0000 1451854800
    ## 66 2016     1   3   22      0      0 +0000 1451858400
    ## 67 2016     1   3   23      0      0 +0000 1451862000
    ## 68 2016     1   4    0      0      0 +0000 1451865600
    ## 69 2016     1   4    1      0      0 +0000 1451869200
    ## 70 2016     1   4    2      0      0 +0000 1451872800
    ## 71 2016     1   4    3      0      0 +0000 1451876400
    ## 72 2016     1   4    4      0      0 +0000 1451880000
    ## 73 2016     1   4    5      0      0 +0000 1451883600
    ## 74 2016     1   4    6      0      0 +0000 1451887200
    ## 75 2016     1   4    7      0      0 +0000 1451890800
    ## 76 2016     1   4    8      0      0 +0000 1451894400
    ## 77 2016     1   4    9      0      0 +0000 1451898000
    ## 78 2016     1   4   10      0      0 +0000 1451901600
    ## 79 2016     1   4   11      0      0 +0000 1451905200
    ## 80 2016     1   4   12      0      0 +0000 1451908800
    ## 81 2016     1   4   13      0      0 +0000 1451912400
    ## 82 2016     1   4   14      0      0 +0000 1451916000
    ## 83 2016     1   4   15      0      0 +0000 1451919600
    ## 84 2016     1   4   16      0      0 +0000 1451923200
    ## 85 2016     1   4   17      0      0 +0000 1451926800
    ## 86 2016     1   4   18      0      0 +0000 1451930400
    ## 87 2016     1   4   19      0      0 +0000 1451934000
    ## 88 2016     1   4   20      0      0 +0000 1451937600
    ## 89 2016     1   4   21      0      0 +0000 1451941200
    ## 90 2016     1   4   22      0      0 +0000 1451944800
    ## 91 2016     1   4   23      0      0 +0000 1451948400
    ## 92 2016     1   5    0      0      0 +0000 1451952000
    ## 93 2016     1   5    1      0      0 +0000 1451955600
    ## 94 2016     1   5    2      0      0 +0000 1451959200
    ## 95 2016     1   5    3      0      0 +0000 1451962800
    ## 96 2016     1   5    4      0      0 +0000 1451966400

### Get single time slice

``` r
## get single time slice #------------
# get second slice: 2016-01-01 01:00
(temp_slice <- temp_array[ , , 2])
```

    ##           [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]
    ##  [1,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [2,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [3,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [4,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [5,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [6,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [7,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [8,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [9,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [10,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [11,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [12,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [13,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [14,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [15,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [16,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [17,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [18,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [19,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [20,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [21,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [22,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [23,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [24,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [25,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [26,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [27,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [28,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [29,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [30,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [31,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [32,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [33,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##          [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]    [,17]    [,18]
    ##  [1,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [2,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [3,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [4,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [5,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [6,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [7,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [8,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [9,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [10,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [11,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [12,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [13,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [14,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [15,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [16,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [17,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [18,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [19,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [20,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [21,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [22,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [23,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [24,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [25,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [26,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [27,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [28,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [29,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [30,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [31,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [32,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ## [33,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##          [,19]    [,20]    [,21]    [,22]    [,23]    [,24]    [,25]    [,26]    [,27]
    ##  [1,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [2,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [3,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [4,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [5,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [6,]       NA       NA       NA       NA       NA       NA       NA       NA       NA
    ##  [7,]       NA       NA       NA       NA       NA       NA       NA       NA 274.5811
    ##  [8,]       NA       NA       NA       NA       NA       NA       NA       NA 274.6619
    ##  [9,]       NA       NA       NA       NA       NA       NA 274.1296 274.1826 274.6860
    ## [10,]       NA       NA       NA       NA       NA 274.3774 274.1294 274.1860 274.7214
    ## [11,]       NA       NA       NA       NA       NA 274.4089 274.1577 274.2280 274.7715
    ## [12,]       NA       NA       NA       NA 274.7168 274.4634 274.2620 274.3464 274.9312
    ## [13,]       NA       NA       NA       NA 274.7629 274.5696 274.3955 274.5356 275.1279
    ## [14,]       NA       NA       NA       NA 274.8074 274.6360 274.5332 274.6904 275.3052
    ## [15,]       NA       NA       NA 274.9856 274.7688 274.6643 274.5894 274.7966 275.4136
    ## [16,]       NA       NA 275.1411 274.8872 274.6914 274.6099 274.6213 274.8276 275.3733
    ## [17,]       NA 275.1765 275.0388 274.7769 274.5874 274.5630 274.6042 274.8281 275.3508
    ## [18,]       NA 275.0618 274.9294 274.6655 274.4785 274.4717 274.5640 274.7844 275.2102
    ## [19,]       NA       NA 274.8086 274.5461 274.3606 274.3638 274.4624 274.6453 275.0244
    ## [20,]       NA       NA       NA       NA 274.2422 274.2437 274.3379 274.4988 274.7290
    ## [21,]       NA       NA       NA       NA 274.1006 274.1187 274.2114 274.3430 274.5247
    ## [22,]       NA       NA       NA       NA 273.9250 273.9558 274.0991 274.2319 274.3811
    ## [23,]       NA       NA       NA       NA 273.6934 273.7988 273.9666 274.1506 274.3086
    ## [24,]       NA       NA       NA 273.5627 273.5293 273.6602 273.8879 274.0874 274.2922
    ## [25,]       NA       NA       NA 273.5706 273.5369 273.7024 273.9517 274.2002 274.4309
    ## [26,]       NA       NA       NA       NA 273.8071 273.9827 274.2222 274.4651 274.7161
    ## [27,]       NA       NA       NA 273.9756 274.0669 274.2534 274.4902 274.7463 275.0156
    ## [28,]       NA       NA       NA 274.2000 274.3401 274.5225 274.7139 274.9805 275.2915
    ## [29,]       NA       NA 274.3018 274.4734 274.6196 274.7493 274.9102 275.1174 275.4426
    ## [30,]       NA       NA 274.5513 274.7407 274.9106 275.0129 275.0559 275.2480 275.6079
    ## [31,]       NA       NA 274.7439 274.9849 275.1592 275.2134 275.2209 275.3838 275.7588
    ## [32,]       NA       NA 274.8313 275.0796 275.2905 275.3499 275.3591 275.5247 275.9670
    ## [33,]       NA       NA 274.8542 275.1416 275.3660 275.4617 275.4788 275.6926 276.1643
    ##          [,28]    [,29]    [,30]
    ##  [1,]       NA 274.7427       NA
    ##  [2,]       NA 274.8076       NA
    ##  [3,]       NA 274.8870       NA
    ##  [4,] 274.6406 274.9978       NA
    ##  [5,] 274.7996 275.1746       NA
    ##  [6,] 274.9539 275.4277       NA
    ##  [7,] 275.1638 275.6638       NA
    ##  [8,] 275.2871 275.8486       NA
    ##  [9,] 275.3728 275.9490       NA
    ## [10,] 275.4214 276.0251       NA
    ## [11,] 275.5222 276.1343       NA
    ## [12,] 275.6970 276.2773       NA
    ## [13,] 275.8889 276.4495       NA
    ## [14,] 276.0659 276.5559       NA
    ## [15,] 276.1086 276.5615       NA
    ## [16,] 276.0388 276.3748       NA
    ## [17,] 275.9275 276.2153       NA
    ## [18,] 275.7546 275.9399       NA
    ## [19,] 275.3755 275.5298       NA
    ## [20,] 275.0134 275.0994       NA
    ## [21,] 274.6824 274.7588 274.7703
    ## [22,] 274.5151 274.6719 274.7705
    ## [23,] 274.4753 274.6938 275.0991
    ## [24,] 274.4731 274.8435 275.3489
    ## [25,] 274.6707 275.0889 275.7744
    ## [26,] 274.9753 275.4988 276.2439
    ## [27,] 275.3357 275.8916 276.7617
    ## [28,] 275.6265 276.2617 277.1729
    ## [29,] 275.8567 276.5261 277.5474
    ## [30,] 276.0461 276.7903 277.8467
    ## [31,] 276.2751 277.0459 278.1758
    ## [32,] 276.5142 277.3359 278.4705
    ## [33,] 276.7991 277.6274 278.6855
    ##  [ reached getOption("max.print") -- omitted 52 rows ]

``` r
dim(temp_slice)
```

    ## [1] 85 30

``` r
# create dataframe -- reshape data
# matrix (nlon*nlat rows by 2 cols) of lons and lats
lonlat <- as.matrix(expand.grid(lon, lat))
dim(lonlat) # 30*85
```

    ## [1] 2550    2

``` r
# vector of `temp` values
temp_vec <- as.vector(temp_slice)
length(temp_vec)
```

    ## [1] 2550

``` r
temp_df01 <- data.frame(cbind(lonlat, temp_vec))
tibble(temp_df01)
```

    ## # A tibble: 2,550 × 3
    ##     Var1  Var2 temp_vec
    ##    <dbl> <dbl>    <dbl>
    ##  1 -83.7  39.4       NA
    ##  2 -83.6  39.4       NA
    ##  3 -83.5  39.4       NA
    ##  4 -83.4  39.4       NA
    ##  5 -83.3  39.4       NA
    ##  6 -83.2  39.4       NA
    ##  7 -83.1  39.4       NA
    ##  8 -83.0  39.4       NA
    ##  9 -82.9  39.4       NA
    ## 10 -82.8  39.4       NA
    ## # ℹ 2,540 more rows

### Reshape whole array

``` r
## reshape whole array #------------
# reshape the array into vector
temp_vec_long <- as.vector(temp_array)
length(temp_vec_long) # 30*85*96
```

    ## [1] 244800

``` r
# reshape the vector into a matrix
nlon <- 85
nlat <- 30
ntime <- 96
temp_matrix <- matrix(temp_vec_long, nrow = nlon*nlat, ncol = ntime)
dim(temp_matrix)
```

    ## [1] 2550   96

``` r
head(na.omit(temp_matrix))
```

    ##          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]
    ## [1,] 275.5894 275.0764 275.3523 275.2307 275.0398 274.7034 274.4814 274.2688 274.1118
    ## [2,] 275.6907 275.1663 275.4729 275.3586 275.1807 274.8489 274.6260 274.4062 274.2463
    ## [3,] 275.7544 275.2505 275.4607 275.3284 275.1428 274.8301 274.6143 274.4177 274.2749
    ## [4,] 275.9668 275.4414 275.6926 275.5703 275.3950 275.0859 274.8711 274.6667 274.5232
    ## [5,] 276.2346 275.6965 275.9756 275.8586 275.7012 275.4011 275.1895 274.9827 274.8376
    ## [6,] 276.5374 275.9856 276.2847 276.1738 276.0300 275.7424 275.5337 275.3242 275.1816
    ##         [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]    [,17]    [,18]
    ## [1,] 274.5503 275.2026 276.1382 276.6824 276.5569 275.8008 276.0776 275.8435 274.9353
    ## [2,] 274.6987 275.3616 276.2954 276.9128 276.8457 276.0044 276.2212 275.9778 275.0676
    ## [3,] 274.6792 275.3254 276.2334 276.8401 276.8027 276.0310 276.2258 275.9590 275.0291
    ## [4,] 274.9473 275.5979 276.5144 277.1799 277.1919 276.3394 276.4990 276.2141 275.2776
    ## [5,] 275.2729 275.9299 276.8271 277.5540 277.6416 276.7173 276.8206 276.5154 275.5742
    ## [6,] 275.6255 276.2822 277.1670 277.9368 278.0955 277.1177 277.1672 276.8428 275.8982
    ##         [,19]    [,20]    [,21]    [,22]    [,23]    [,24]    [,25]    [,26]    [,27]
    ## [1,] 274.1321 273.6753 273.4150 273.1187 273.1675 273.0593 272.7424 272.6548 272.9468
    ## [2,] 274.2534 273.7886 273.5171 273.2004 273.2378 273.1433 272.8108 272.7476 273.0454
    ## [3,] 274.1995 273.6980 273.4202 273.0989 273.0999 272.9961 272.7129 272.6509 272.9370
    ## [4,] 274.4380 273.9246 273.6514 273.3064 273.2886 273.1819 272.8730 272.8269 273.1318
    ## [5,] 274.7244 274.2036 273.9607 273.5967 273.5581 273.4524 273.1235 273.0994 273.4116
    ## [6,] 275.0359 274.5061 274.3015 273.9197 273.8560 273.7463 273.3984 273.3923 273.7148
    ##         [,28]    [,29]    [,30]    [,31]    [,32]    [,33]    [,34]    [,35]    [,36]
    ## [1,] 272.5386 272.2876 272.1272 271.8955 271.7102 271.6938 272.7559 274.0942 275.4861
    ## [2,] 272.6316 272.3477 272.1841 271.9319 271.7400 271.7271 272.8164 274.1907 275.5759
    ## [3,] 272.5784 272.3428 272.1802 271.9714 271.7971 271.7881 272.8606 274.2703 275.6885
    ## [4,] 272.7639 272.5012 272.3398 272.1106 271.9314 271.9307 273.0322 274.4783 275.9019
    ## [5,] 273.0442 272.7490 272.5781 272.3279 272.1445 272.1475 273.2837 274.7744 276.1938
    ## [6,] 273.3513 273.0273 272.8430 272.5740 272.3887 272.3901 273.5603 275.0928 276.5083
    ##         [,37]    [,38]    [,39]    [,40]    [,41]    [,42]    [,43]    [,44]    [,45]
    ## [1,] 276.6582 277.4919 278.2085 278.2698 277.6677 276.1582 274.8506 273.9871 273.5078
    ## [2,] 276.7595 277.6223 278.3909 278.4475 277.8447 276.2859 274.9636 274.0913 273.6079
    ## [3,] 276.8621 277.7434 278.5149 278.6016 278.0042 276.4087 275.0581 274.1758 273.6091
    ## [4,] 277.0930 277.9927 278.8003 278.8970 278.2969 276.6577 275.2959 274.4099 273.8257
    ## [5,] 277.3958 278.3057 279.1604 279.2578 278.6584 276.9780 275.6125 274.7373 274.0984
    ## [6,] 277.7212 278.6360 279.5342 279.6382 279.0422 277.3328 275.9744 275.1128 274.4231
    ##         [,46]    [,47]    [,48]    [,49]    [,50]    [,51]    [,52]    [,53]    [,54]
    ## [1,] 273.1489 272.9485 272.8188 272.6963 272.5039 272.5264 272.4153 272.5884 272.7300
    ## [2,] 273.1975 272.9163 272.7222 272.5461 272.3462 272.3794 272.3811 272.3967 272.4653
    ## [3,] 273.1990 272.9519 272.7788 272.6279 272.4727 272.4819 272.3345 272.4050 272.5242
    ## [4,] 273.3813 273.0583 272.8125 272.6125 272.4595 272.4680 272.3521 272.3394 272.4102
    ## [5,] 273.6262 273.2292 272.9111 272.6841 272.5566 272.5801 272.3706 272.2573 272.2683
    ## [6,] 273.9392 273.4810 273.0981 272.8347 272.6953 272.7317 272.4854 272.3208 272.2791
    ##         [,55]    [,56]    [,57]    [,58]    [,59]    [,60]    [,61]    [,62]    [,63]
    ## [1,] 272.6465 272.5161 272.5010 274.1973 276.1069 277.3313 278.3838 279.1804 279.8794
    ## [2,] 272.3623 272.2302 272.2214 274.1086 276.2126 277.4446 278.4958 279.3223 280.1025
    ## [3,] 272.4966 272.2883 272.4148 274.1624 276.1899 277.4573 278.5334 279.3691 280.1768
    ## [4,] 272.3669 272.3511 272.2554 274.1543 276.3704 277.6558 278.7500 279.6013 280.4988
    ## [5,] 272.2717 272.4927 272.2356 274.1565 276.5771 277.8755 278.9824 279.8513 280.8396
    ## [6,] 272.4194 272.3340 272.1404 274.1719 276.7781 278.1040 279.2195 280.0989 281.1824
    ##         [,64]    [,65]    [,66]    [,67]    [,68]    [,69]    [,70]    [,71]    [,72]
    ## [1,] 279.2776 278.0857 276.7505 275.9202 275.3079 274.6926 274.2822 273.7666 273.1213
    ## [2,] 279.5286 278.3357 276.9390 276.0967 275.4634 274.7944 274.3706 273.8452 273.1892
    ## [3,] 279.5903 278.3901 276.9536 276.0378 275.3901 274.8718 274.4968 274.0208 273.4380
    ## [4,] 279.9431 278.7490 277.2478 276.3047 275.6440 275.1130 274.7332 274.2427 273.6482
    ## [5,] 280.3105 279.1284 277.5625 276.6028 275.9258 275.4502 275.0625 274.5659 273.9685
    ## [6,] 280.6855 279.5232 277.8997 276.9199 276.2297 275.8091 275.4092 274.9050 274.3081
    ##         [,73]    [,74]    [,75]    [,76]    [,77]    [,78]    [,79]    [,80]    [,81]
    ## [1,] 272.4927 271.9272 271.8542 271.9314 271.9653 271.9316 271.7705 271.4062 271.1917
    ## [2,] 272.5576 271.9758 271.8677 271.9370 271.9854 271.9814 271.8350 271.4810 271.2756
    ## [3,] 272.7969 272.1348 271.9990 272.0061 272.0107 271.9858 271.8389 271.4741 271.2966
    ## [4,] 273.0024 272.3250 272.1414 272.1353 272.1501 272.1528 272.0337 271.6753 271.5037
    ## [5,] 273.3262 272.6440 272.4148 272.3867 272.4089 272.4346 272.3396 271.9951 271.8311
    ## [6,] 273.6707 272.9944 272.7249 272.6697 272.6956 272.7393 272.6741 272.3459 272.1914
    ##         [,82]    [,83]    [,84]    [,85]    [,86]    [,87]    [,88]    [,89]    [,90]
    ## [1,] 271.4382 271.8577 272.2280 272.6929 272.7556 272.1099 271.5684 270.7942 269.8501
    ## [2,] 271.5195 271.9507 272.3313 272.8049 272.8726 272.2524 271.7031 270.9133 269.9573
    ## [3,] 271.5947 272.0337 272.4207 272.8889 272.9495 272.3110 271.7761 270.9895 270.0249
    ## [4,] 271.8132 272.2617 272.6550 273.1353 273.2080 272.5955 272.0566 271.2480 270.2698
    ## [5,] 272.1445 272.6040 273.0068 273.4927 273.5708 272.9988 272.4512 271.6226 270.6265
    ## [6,] 272.5076 272.9709 273.3801 273.8711 273.9575 273.4265 272.8748 272.0249 271.0134
    ##         [,91]    [,92]    [,93]    [,94]    [,95]    [,96]
    ## [1,] 269.1194 268.4907 268.1284 267.2827 266.6719 266.1814
    ## [2,] 269.2324 268.5969 268.2441 267.3738 266.7478 266.2559
    ## [3,] 269.3088 268.7053 268.2512 267.4395 266.8384 266.3293
    ## [4,] 269.5569 268.9551 268.4573 267.6184 266.9932 266.4756
    ## [5,] 269.9209 269.3142 268.6682 267.8069 267.1582 266.6399
    ## [6,] 270.3149 269.7144 268.8984 268.0161 267.3435 266.8201

``` r
# create a dataframe
lonlat <- as.matrix(expand.grid(lon,lat))
temp_df02 <- data.frame(cbind(lonlat,temp_matrix))
tibble(temp_df02)
```

    ## # A tibble: 2,550 × 98
    ##     Var1  Var2    V3    V4    V5    V6    V7    V8    V9   V10   V11   V12   V13   V14
    ##    <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
    ##  1 -83.7  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ##  2 -83.6  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ##  3 -83.5  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ##  4 -83.4  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ##  5 -83.3  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ##  6 -83.2  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ##  7 -83.1  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ##  8 -83.0  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ##  9 -82.9  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ## 10 -82.8  39.4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
    ## # ℹ 2,540 more rows
    ## # ℹ 84 more variables: V15 <dbl>, V16 <dbl>, V17 <dbl>, V18 <dbl>, V19 <dbl>, V20 <dbl>,
    ## #   V21 <dbl>, V22 <dbl>, V23 <dbl>, V24 <dbl>, V25 <dbl>, V26 <dbl>, V27 <dbl>,
    ## #   V28 <dbl>, V29 <dbl>, V30 <dbl>, V31 <dbl>, V32 <dbl>, V33 <dbl>, V34 <dbl>,
    ## #   V35 <dbl>, V36 <dbl>, V37 <dbl>, V38 <dbl>, V39 <dbl>, V40 <dbl>, V41 <dbl>,
    ## #   V42 <dbl>, V43 <dbl>, V44 <dbl>, V45 <dbl>, V46 <dbl>, V47 <dbl>, V48 <dbl>,
    ## #   V49 <dbl>, V50 <dbl>, V51 <dbl>, V52 <dbl>, V53 <dbl>, V54 <dbl>, V55 <dbl>, …

## Reshaping from rectangular to raster (later)

``` r
# dataframe to raster #-----------------------
```
